
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../stack_machines/">
      
      
        <link rel="next" href="../setup_geocodes_services_containers/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Base Machine - Geocodes Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#setup-machine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Geocodes Documentation" class="md-header__button md-logo" aria-label="Geocodes Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Geocodes Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Base Machine
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/earthcube/geocodes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  How To Create a Geocodes Server

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  Setup

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data_loading/setup_indexing_with_gleanerio/" class="md-tabs__link">
          
  
  
    
  
  Load Data

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../production" class="md-tabs__link">
          
  
  
    
  
  Production

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data_loading/install_glcon/" class="md-tabs__link">
          
  
  
    
  
  Tooling

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/" class="md-tabs__link">
          
  
  
    
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../production/sparql/" class="md-tabs__link">
          
  
  
    
  
  Help

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Geocodes Documentation" class="md-nav__button md-logo" aria-label="Geocodes Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Geocodes Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/earthcube/geocodes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    How To Create a Geocodes Server
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            How To Create a Geocodes Server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stack_machines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    List of services
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Base Machine
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Base Machine
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#base-machine-to-run-docker-containers-treafik-and-portainer" class="md-nav__link">
    <span class="md-ellipsis">
      Base Machine to run Docker Containers Treafik and Portainer:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Step Overview:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-details" class="md-nav__link">
    <span class="md-ellipsis">
      Step Details:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step Details:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-machine-in-openstack" class="md-nav__link">
    <span class="md-ellipsis">
      create a machine in openstack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create a machine in openstack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-domain-names" class="md-nav__link">
    <span class="md-ellipsis">
      setup domain names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-to-machine-and-verify" class="md-nav__link">
    <span class="md-ellipsis">
      ssh to machine and verify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-a-base-server" class="md-nav__link">
    <span class="md-ellipsis">
      configure a base server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="configure a base server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-os" class="md-nav__link">
    <span class="md-ellipsis">
      update OS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update OS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-docker-git" class="md-nav__link">
    <span class="md-ellipsis">
      add docker, git
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-directory-for-geocodes-set-up-permissions-and-groups" class="md-nav__link">
    <span class="md-ellipsis">
      create a directory for geocodes, set up permissions and groups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clone-geocodes-stack" class="md-nav__link">
    <span class="md-ellipsis">
      clone geocodes stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-base_machineexampleenv-to-env" class="md-nav__link">
    <span class="md-ellipsis">
      copy base_machine.example.env, to .env
    </span>
  </a>
  
    <nav class="md-nav" aria-label="copy base_machine.example.env, to .env">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-production-server-use-env" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1. production server use .env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-testing-playing-developer" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2. testing, playing, developer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-the-treafik-datatraefikyml" class="md-nav__link">
    <span class="md-ellipsis">
      modify the treafik-data/traefik.yml
    </span>
  </a>
  
    <nav class="md-nav" aria-label="modify the treafik-data/traefik.yml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-the-base-containers" class="md-nav__link">
    <span class="md-ellipsis">
      start the base containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#go-to-step-2" class="md-nav__link">
    <span class="md-ellipsis">
      Go to step 2.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Go to step 2.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-totroubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      How to/Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to/Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-portainer-or-treafik" class="md-nav__link">
    <span class="md-ellipsis">
      updating Portainer, or treafik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="updating Portainer, or treafik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-tos-needed" class="md-nav__link">
    <span class="md-ellipsis">
      How tos needed:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_geocodes_services_containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Services Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup_gleaner_container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Gleaner Containers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Test Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/indexing_with_gleanerio_for_testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            User Interface
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setting_up_user_interface/setup_geocodes_ui_containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Geocodes UI Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setting_up_user_interface/tenant" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating a Community Instance (Tenant)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Load Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Load Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/setup_indexing_with_gleanerio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/configuration" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/onboarding_or_testing_a_datasource/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Onboarding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/dataloading_troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Loading Trouble shooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/using_screen_for_manual_loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manual Loading with screen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/watching_manual_gleanerio_data_loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Loading - Watching CLI/Manual Loading
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Production
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Production
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../production" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../production/creatingAndLoadingProduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating and Loading Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../production/managing_services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/onboarding_or_testing_a_datasource/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Onboarding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../production/production_ui_deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Production UI DNS changes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tooling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tooling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_loading/install_glcon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install Glcon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Earthcube Utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Earthcube Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://earthcube.github.io/earthcube_utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://earthcube.github.io/earthcube_utilities/earthcube_utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Earthcube Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://earthcube.github.io/earthcube_utilities/summarize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Summarize
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../development/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/local_stacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local Stacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/development/localdeveloper_configs.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration examples (TBD)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Help
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Help
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../production/sparql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Some SPARQL Queries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#base-machine-to-run-docker-containers-treafik-and-portainer" class="md-nav__link">
    <span class="md-ellipsis">
      Base Machine to run Docker Containers Treafik and Portainer:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Step Overview:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-details" class="md-nav__link">
    <span class="md-ellipsis">
      Step Details:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step Details:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-machine-in-openstack" class="md-nav__link">
    <span class="md-ellipsis">
      create a machine in openstack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create a machine in openstack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-domain-names" class="md-nav__link">
    <span class="md-ellipsis">
      setup domain names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-to-machine-and-verify" class="md-nav__link">
    <span class="md-ellipsis">
      ssh to machine and verify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-a-base-server" class="md-nav__link">
    <span class="md-ellipsis">
      configure a base server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="configure a base server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-os" class="md-nav__link">
    <span class="md-ellipsis">
      update OS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update OS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-docker-git" class="md-nav__link">
    <span class="md-ellipsis">
      add docker, git
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-directory-for-geocodes-set-up-permissions-and-groups" class="md-nav__link">
    <span class="md-ellipsis">
      create a directory for geocodes, set up permissions and groups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clone-geocodes-stack" class="md-nav__link">
    <span class="md-ellipsis">
      clone geocodes stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-base_machineexampleenv-to-env" class="md-nav__link">
    <span class="md-ellipsis">
      copy base_machine.example.env, to .env
    </span>
  </a>
  
    <nav class="md-nav" aria-label="copy base_machine.example.env, to .env">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-production-server-use-env" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1. production server use .env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-testing-playing-developer" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2. testing, playing, developer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-the-treafik-datatraefikyml" class="md-nav__link">
    <span class="md-ellipsis">
      modify the treafik-data/traefik.yml
    </span>
  </a>
  
    <nav class="md-nav" aria-label="modify the treafik-data/traefik.yml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-the-base-containers" class="md-nav__link">
    <span class="md-ellipsis">
      start the base containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#go-to-step-2" class="md-nav__link">
    <span class="md-ellipsis">
      Go to step 2.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Go to step 2.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-totroubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      How to/Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to/Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-portainer-or-treafik" class="md-nav__link">
    <span class="md-ellipsis">
      updating Portainer, or treafik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="updating Portainer, or treafik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-tos-needed" class="md-nav__link">
    <span class="md-ellipsis">
      How tos needed:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/earthcube/geocodes/blob/docs/docs/setting_up_services/setup_base_machine_configuration.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/earthcube/geocodes/raw/docs/docs/setting_up_services/setup_base_machine_configuration.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
    </a>
  


<h1 id="setup-machine">Setup Machine:<a class="headerlink" href="#setup-machine" title="Permanent link"></a></h1>
<p>This is step 1 of 5 major steps:</p>
<ol>
<li><a href="../../stack_machines/">Install base containers on a server</a></li>
<li><a href="../setup_geocodes_services_containers/">Setup services containers</a></li>
<li><a href="../setup_gleaner_container/">Setup Gleaner containers</a></li>
<li><a href="../../data_loading/setup_indexing_with_gleanerio/">Initial setup of services and loading of data</a></li>
<li><a href="../../setting_up_user_interface/setup_geocodes_ui_containers/">Setup Geocodes UI using datastores defined in Initial Setup</a></li>
</ol>
<h2 id="base-machine-to-run-docker-containers-treafik-and-portainer">Base Machine to run Docker Containers Treafik and Portainer:<a class="headerlink" href="#base-machine-to-run-docker-containers-treafik-and-portainer" title="Permanent link"></a></h2>
<p>This is what will be needed to create a production server</p>
<ul>
<li>base virtual machine for containers</li>
<li>ability to request DNS,</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">SUMMARY</p>
<p>These are a summary of the steps, The <a href="#Step Details">Step Details</a> are below.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">DOCKER REQUIREMENT</p>
<p>If you are running on <strong>Ubuntu</strong>, you need to remove the provided docker.com version. <a href="https://docs.docker.com/engine/install/ubuntu/">Official docker package</a>
We suggest that for others, confirm that you can run </p>
<pre class="highlight"><code class="language-shell">docker compose version
Docker Compose version v2.13.0</code></pre>
<p>If you cannot run <code>docker compose</code> then update to the docker.com version
This is the version we are presently running.</p>
<pre class="highlight"><code>Client: Docker Engine - Community
     Version:           20.10.21
     API version:       1.41</code></pre>
</div>
<div class="admonition warning">
<p class="admonition-title">DOCKER SWARM</p>
<p>Docker swarm needs to be init'd with the public ip address.</p>
</div>
<hr />
<h2 id="step-overview">Step Overview:<a class="headerlink" href="#step-overview" title="Permanent link"></a></h2>
<ul>
<li>create a machine in openstack (if production)<ul>
<li>select size</li>
<li>associate floating IP<ul>
<li>ask for DNS for that ip to be configured with needed names</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ssh to machine. You do not need to have the DNS's to install the software. But it will be needed.</p>
<ul>
<li>update apt<ul>
<li><code>sudo apt update</code></li>
</ul>
</li>
<li>
<p>update base software</p>
<ul>
<li><code>sudo apt upgrade</code></li>
</ul>
</li>
<li>
<p>install docker</p>
</li>
</ul>
</li>
</ul>
<details class="danger">
<summary>Use Official Docker for Ubuntu</summary>
<ul>
<li>
<p><strong>use these docker install</strong> <a href="https://docs.docker.com/engine/install/ubuntu/">instructions</a></p>
</li>
<li>
<p>add ubuntu (or other users) to docker group</p>
<ul>
<li><code>sudo groupadd docker</code></li>
<li><code>sudo usermod -aG docker ubuntu</code></li>
</ul>
</li>
<li>reboot</li>
<li><code>sudo reboot now</code></li>
</ul>
</details>
<ul>
<li>create a directory for geocodes, set up permissions and groups<ul>
<li><code>sudo mkdir /data/decoder</code></li>
<li><code>ln -s /data/decoder/ decoder</code></li>
<li><code>ln -s /data/decoder/ geocodes</code></li>
<li><code>sudo addgroup geocodes</code></li>
<li><code>usermod -a -G geocodes {user}</code></li>
<li><code>sudo chgrp geocodes /data/decoder</code></li>
<li><code>sudo chmod g+rwx /data/decoder</code></li>
</ul>
</li>
<li>init docker swarm<ul>
<li>
<div class="admonition warning">
<p class="admonition-title">DOCKER SWARM</p>
  Docker swarm needs to be init'd with the public ip address.</div>
</li>
<li><code>nslookup {HOSTNAME}</code></li>
<li><code>sudo docker swarm init --advertise-addr {PUBLIC_IP}</code></li>
<li>save the token to a file (I use NOTES)</li>
</ul>
</li>
<li>verify proper base configuration<ul>
<li><code>docker compose --help</code> shows a -p flag</li>
</ul>
</li>
<li>SNAPSHOT and creaate an image<ul>
<li></li>
</ul>
</li>
<li>clone geocodes<ul>
<li><code>cd decoder</code> or <code>cd /data/decoder</code></li>
<li><code>git clone https://github.com/earthcube/geocodes.git</code></li>
</ul>
</li>
<li>configure a base server</li>
<li>base-machine-compose.yaml is the full stack with a portainer, treafik</li>
<li>base-swarm-compose.yaml is just a treakfit. connect with your existing portainer.</li>
<li>take a break and wait for the DNS entries.<ul>
<li>if you cannot wait for the DNS, you can go to the no cert port <ul>
<li>https://{HOST}}:9443/</li>
<li>use chrome, click advanced, and go to the port.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h2 id="step-details">Step Details:<a class="headerlink" href="#step-details" title="Permanent link"></a></h2>
<h3 id="create-a-machine-in-openstack">create a machine in openstack<a class="headerlink" href="#create-a-machine-in-openstack" title="Permanent link"></a></h3>
<div class="admonition info">
<p class="admonition-title">Suggested size:</p>
<p>SDSC Openstack:</p>
<ul>
<li>ubuntu 22</li>
<li>100 gig<ul>
<li>m1.2xlarge (8 CPU, 32 gig)</li>
<li>network: earthcube</li>
</ul>
</li>
<li>Security groups:<ul>
<li>remote ssh (22)</li>
<li>geocodes (http/https; 80:443)</li>
<li>portainer (temporary need: 9443)</li>
<li>minio (optional: 9000/9001)</li>
</ul>
</li>
<li>Keypair: earthcube (or any)</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Ports Pre-DNS</p>
<p>minio ports do not need to be open, we are proxying on 80 and 443
Portainer port (9443)  can be opended temporarily if you want to play a bit pre-DNS.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Associate a Public IP</p>
<p>After the machine is created, we can change the IP to the one associated with geocodes.earthcube.org</p>
</div>
<hr />
<h4 id="setup-domain-names">setup domain names<a class="headerlink" href="#setup-domain-names" title="Permanent link"></a></h4>
<ul>
<li><a href="../../stack_machines/">Machines</a></li>
<li><a href="https://raw.githubusercontent.com/earthcube/geocodes/main/deployment/hosts.geocodess">Name for remote DNS</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">ESSENTIAL for PRODUCTION</p>
<p>It is ESSENTIAL for PRODUCTION that the names are defined in a DNS. This allows for https for all services
and some services (aka s3/minio) do not play well with a proxy.</p>
</div>
<p>You might be able to run production stack using localhost, with these DNS...
but that mucks with the lets encrypt HTTPS certs... if you control your own DNS, these are the 
entries needed.  <a href="https://raw.githubusercontent.com/earthcube/geocodes/main/deployment/hosts.geocodes-local">Name for local DNS</a></p>
<p><a href="../../development/local_stacks/">Local testing and development</a> can be using  the local compose configuration. This use http, and 
local ports for services that cannot be proxied</p>
<hr />
<h3 id="ssh-to-machine-and-verify">ssh to machine and verify<a class="headerlink" href="#ssh-to-machine-and-verify" title="Permanent link"></a></h3>
<p><code>ssh -i ~/.ssh/earthcube.pem ubuntu@{public IP}</code></p>
<details class="info">
<summary>add your ssh key so you can log in as main user (eg. ubuntu)</summary>
<p>SSH Keys</p>
<p>for production, we recommend that you use a group account/main account</p>
<p>to do this you will need to create and copy a public/private key</p>
<p>Generate an ssh-key:</p>
<pre class="highlight"><code class="language-copy">ssh-keygen -t rsa -b 4096 -C "comment"</code></pre>
<p>copy it to your remote server:</p>
<pre class="highlight"><code class="language-copy">ssh-copy-id user@ip</code></pre>
<p>or you can manually copy the
<pre class="highlight"><code>~/.ssh/id_rsa.pub to ~/.ssh/authorized_keys.</code></pre></p>
<p>Edit</p>
<p>It can be done through ssh command as mentioned @chepner:</p>
<p><pre class="highlight"><code>ssh user@ip 'mkdir ~/.ssh'
ssh user@ip 'cat &gt;&gt; ~/.ssh/authorized_keys' &lt; ~/.ssh/id_rsa.pub</code></pre>
(Above based on: <a href="https://unix.stackexchange.com/questions/630186/how-to-add-ssh-keys-to-a-specific-user-in-linux">stackexchange</a>)</p>
</details>
<hr />
<h3 id="configure-a-base-server">configure a base server<a class="headerlink" href="#configure-a-base-server" title="Permanent link"></a></h3>
<h4 id="update-os">update OS<a class="headerlink" href="#update-os" title="Permanent link"></a></h4>
<ul>
<li>update apt<ul>
<li><code>sudo apt update</code></li>
</ul>
</li>
<li>update base software<ul>
<li>`sudo apt upgrade</li>
</ul>
</li>
</ul>
<h5 id="add-docker-git">add docker, git<a class="headerlink" href="#add-docker-git" title="Permanent link"></a></h5>
<details class="note">
<summary>Offical Docker for Ubuntu</summary>
<p><strong>use these docker install</strong> <a href="https://docs.docker.com/engine/install/ubuntu/">instruction</a></p>
</details>
<ul>
<li>add ubuntu (or other users) to docker group</li>
<li><code>sudo groupadd docker</code></li>
<li><code>sudo usermod -aG docker ubuntu</code></li>
<li>reboot</li>
<li><code>sudo reboot now</code></li>
</ul>
<h5 id="create-a-directory-for-geocodes-set-up-permissions-and-groups">create a directory for geocodes, set up permissions and groups<a class="headerlink" href="#create-a-directory-for-geocodes-set-up-permissions-and-groups" title="Permanent link"></a></h5>
<pre class="highlight"><code>* `sudo mkdir /data/decoder`
* `ln -s /data/decoder/ decoder`
* `sudo addgroup geocodes`
* `usermod -a -G geocodes {user}`
* `sudo chgrp geocodes /data/decoder`
* `sudo chmod g+rwx /data/decoder`</code></pre>
<h5 id="clone-geocodes-stack">clone geocodes stack<a class="headerlink" href="#clone-geocodes-stack" title="Permanent link"></a></h5>
<ul>
<li><code>cd decoder</code> or <code>cd /data/decoder</code></li>
<li><code>git clone https://github.com/earthcube/geocodes.git</code></li>
<li><code>cd geocodes/deployment</code></li>
</ul>
<h5 id="copy-base_machineexampleenv-to-env">copy  base_machine.example.env, to .env<a class="headerlink" href="#copy-base_machineexampleenv-to-env" title="Permanent link"></a></h5>
<h6 id="option-1-production-server-use-env">Option 1. production server use .env<a class="headerlink" href="#option-1-production-server-use-env" title="Permanent link"></a></h6>
<ul>
<li><code>cp base_machine.example.env .env</code></li>
<li>modify the file<ul>
<li>note: you can also copy the full portainer.env. </li>
</ul>
</li>
</ul>
<h6 id="option-2-testing-playing-developer">Option 2. testing, playing, developer<a class="headerlink" href="#option-2-testing-playing-developer" title="Permanent link"></a></h6>
<ul>
<li><code>cp base_machine.example.env {myproject}.env</code></li>
<li>modify the file<ul>
<li>note: you can also copy the full portainer.env.</li>
</ul>
</li>
</ul>
<h5 id="modify-the-treafik-datatraefikyml">modify the treafik-data/traefik.yml<a class="headerlink" href="#modify-the-treafik-datatraefikyml" title="Permanent link"></a></h5>
<details class="example" open="open">
<summary>treafik-data/traefik.yml</summary>
<p><pre class="highlight"><code class="language-yaml copy">acme:
# using staging for testing/development
#     caServer: https://acme-staging-v02.api.letsencrypt.org/directory
    email: example@earthcube.org
    storage: acme.json
    httpChallenge:
        entryPoint: http</code></pre>
If production, comment the line as shown. Developers see Lets Encypt Notes </p>
</details>
<details class="note">
<summary>Let Encrypt Notes</summary>
<p><a href="https://doc.traefik.io/traefik/https/acme/">lets encrypt</a>, </p>
<p>(developers) set to use <a href="https://letsencrypt.org/docs/staging-environment/">staging environment</a> server while testing
If you are doing development, then leave the caServer uncommented.</p>
</details>
<h6 id="start-the-base-containers">start the base containers<a class="headerlink" href="#start-the-base-containers" title="Permanent link"></a></h6>
<ul>
<li>new machine or developer</li>
<li>
<p><code>./run_base.sh -e  {myproject}.env</code></p>
</li>
<li>
<p><strong>production</strong>: this uses the default .env (cp  portainer.env .env)</p>
</li>
</ul>
<details class="example">
<summary><code>./run_base.sh</code></summary>
<pre class="highlight"><code class="language-shell">      ubuntu@geocodes-dev:~/geocodes/deployment$ ./run_base.sh -e geocodes-1.env
      Error response from daemon: network with name traefik_proxy already exists
      NETWORK ID     NAME              DRIVER    SCOPE
      ad6cbce4ec60   bridge            bridge    local
      2f618fa7da6d   docker_gwbridge   bridge    local
      f8048bc7a3d9   host              host      local
      kibdi510bt0x   ingress           overlay   swarm
      12c01a2186b0   none              null      local
      u4d4oxfy7olc   traefik_proxy     overlay   swarm
      Verify that the traefik_proxy network SCOPE is swarm
      traefik_data
      portainer_data
      true
      [+] Running 2/2
      ⠿ Container portainer  Started                                           13.7s
      ⠿ Container traefik    Started</code></pre>
</details>
<h6 id="testing-setup">Testing Setup<a class="headerlink" href="#testing-setup" title="Permanent link"></a></h6>
<hr />
<details class="example">
<summary><code>Are containers running</code></summary>
<p><code>docker ps</code>
<pre class="highlight"><code class="language-shell">    * ubuntu@geocodes-dev:~/geocodes/deployment$ docker ps
      CONTAINER ID   IMAGE                           COMMAND                  CREATED         STATUS         PORTS                                                                      NAMES
      09a5d8683cce   traefik:v2.4                    "/entrypoint.sh trae…"   2 minutes ago   Up 2 minutes   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, :::443-&gt;443/tcp   traefik
      d3e2333ade6f   portainer/portainer-ce:latest   "/portainer"             2 minutes ago   Up 2 minutes   8000/tcp, 9000/tcp, 9443/tcp                                               portainer</code></pre></p>
</details>
<hr />
<details class="example">
<summary>Is network setup correctly?</summary>
<p><code>docker network ls</code>
<pre class="highlight"><code class="language-shell">docker network ls
      NETWORK ID     NAME              DRIVER    SCOPE
      ad6cbce4ec60   bridge            bridge    local
      2f618fa7da6d   docker_gwbridge   bridge    local
      f8048bc7a3d9   host              host      local
      kibdi510bt0x   ingress           overlay   swarm
      12c01a2186b0   none              null      local
      u4d4oxfy7olc   traefik_proxy     overlay   swarm</code></pre></p>
<details class="note">
<summary>Note</summary>
<p>NAME:traefik_proxy needs to exist, and be DRIVER:overlay, SCOPE:swarm</p>
</details>
</details>
<details class="example">
<summary>Are volumes available</summary>
<p><code>docker volumes</code>
<pre class="highlight"><code class="language-shell">ubuntu@geocodes-dev:~$ docker volume ls
      DRIVER    VOLUME NAME
      local     graph
      local     minio
      local     portainer_data
      local     traefik_data</code></pre></p>
</details>
<hr />
<p><strong>are Traefik and Portainer available via the web?</strong></p>
<ul>
<li><strong>Treafik</strong> https://admin.{host}<ul>
<li>login is admin:iforget</li>
</ul>
</li>
</ul>
<details class="info">
<summary>image</summary>
<p><a class="glightbox" href="../../images/traefik_admin.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Traefik_admin" src="../../images/traefik_admin.png" /></a></p>
</details>
<ul>
<li><strong>Portainer</strong> https://portainer.{host}/<ul>
<li>this will ask you to setup and admin password</li>
</ul>
</li>
</ul>
<details class="info">
<summary>image</summary>
<p><a class="glightbox" href="../../images/portainer_home.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Portainer" src="../../images/portainer_home.png" /></a></p>
</details>
<h2 id="go-to-step-2">Go to step 2.<a class="headerlink" href="#go-to-step-2" title="Permanent link"></a></h2>
<ol>
<li><a href="../../stack_machines/">Install base containers on a server</a></li>
<li><a href="../setup_geocodes_services_containers/">Setup services containers</a></li>
<li><a href="../setup_gleaner_container/">Setup Gleaner containers</a></li>
<li><a href="../../data_loading/setup_indexing_with_gleanerio/">Initial setup of services and loading of data</a></li>
<li><a href="../../setting_up_user_interface/setup_geocodes_ui_containers/">Setup Geocodes UI using datastores defined in Initial Setup</a></li>
</ol>
<hr />
<h4 id="how-totroubleshooting">How to/Troubleshooting<a class="headerlink" href="#how-totroubleshooting" title="Permanent link"></a></h4>
<h5 id="updating-portainer-or-treafik">updating Portainer, or treafik<a class="headerlink" href="#updating-portainer-or-treafik" title="Permanent link"></a></h5>
<p>the latest image needs to be pulled</p>
<p><code>docker pull portainer/portainer-ce:latest</code></p>
<p>then
<code>./run_base.sh</code></p>
<h6 id="how-tos-needed">How tos needed:<a class="headerlink" href="#how-tos-needed" title="Permanent link"></a></h6>
<ul>
<li>LOCAL DNS SETUP</li>
<li>editing your local machine /etc/hosts file does not work with letsencrypt. </li>
<li>If user has a local name server they control, that might work.</li>
<li>setup a new password for traefik</li>
<li>lets encrypt</li>
</ul>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../stack_machines/" class="md-footer__link md-footer__link--prev" aria-label="Previous: List of services">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                List of services
              </div>
            </div>
          </a>
        
        
          
          <a href="../setup_geocodes_services_containers/" class="md-footer__link md-footer__link--next" aria-label="Next: Create Services Containers">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Create Services Containers
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://earthcube.slack.com" target="_blank" rel="noopener" title="Earthcube on Slack" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M94.1 315.1c0 25.9-21.2 47.1-47.1 47.1S0 341 0 315.1 21.2 268 47.1 268h47.1v47.1zm23.7 0c0-25.9 21.2-47.1 47.1-47.1s47.1 21.2 47.1 47.1v117.8c0 25.9-21.2 47.1-47.1 47.1s-47.1-21.2-47.1-47.1zm47.1-189c-25.9 0-47.1-21.2-47.1-47.1s21.2-47 47.1-47S212 53.2 212 79.1v47.1h-47.1zm0 23.7c25.9 0 47.1 21.2 47.1 47.1S190.8 244 164.9 244H47.1C21.2 244 0 222.8 0 196.9s21.2-47.1 47.1-47.1zm189 47.1c0-25.9 21.2-47.1 47.1-47.1s47 21.2 47 47.1-21.2 47.1-47.1 47.1h-47.1v-47.1zm-23.7 0c0 25.9-21.2 47.1-47.1 47.1S236 222.8 236 196.9V79.1c0-25.9 21.2-47.1 47.1-47.1s47.1 21.2 47.1 47.1zm-47.1 189c25.9 0 47.1 21.2 47.1 47.1s-21.2 47-47.1 47-47.1-21.2-47.1-47.1v-47.1h47.1zm0-23.7c-25.9 0-47.1-21.2-47.1-47.1s21.2-47.1 47.1-47.1h117.8c25.9 0 47.1 21.2 47.1 47.1s-21.2 47.1-47.1 47.1z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/earthcube/geocodes" target="_blank" rel="noopener" title="Geocodes on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://hub.docker.com/?namespace=nsfearthcube" target="_blank" rel="noopener" title="Earthcube on Dockerhub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "navigation.sections", "navigation.tabs", "navigation.path", "navigation.indexes", "navigation.footer", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>